FROM openjdk:21-slim

ARG DB_URL="jdbc:postgresql://localhost:5432/geofence_db"
ARG DB_USERNAME=postgres
ARG DB_PASSWORD=postgres
ARG JAVA_OPTS
ARG SPRING_PROFILES_ACTIVE=development

ENV JAVA_OPTS=$JAVA_OPTS
ENV SPRING_PROFILES_ACTIVE=$SPRING_PROFILES_ACTIVE
ENV SERVICE_NAME=geofence-service
ARG JAR_FILE=target/*.jar
ADD ${JAR_FILE} ${SERVICE_NAME}.jar

EXPOSE 8081

ENTRYPOINT ["sh", "-c", "java $JAVA_OPTS -DSPRING_PROFILES_ACTIVE=$SPRING_PROFILES_ACTIVE -DDB_URL=$POSTGRES_GEOFENCE_URL -DDB_USERNAME=$POSTGRES_USER -DDB_PASSWORD=$POSTGRES_PASSWORD -jar $SERVICE_NAME.jar"]
