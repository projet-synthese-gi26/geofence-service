spring.application.name=geofence
spring.datasource.url=jdbc:postgresql://${DB_HOST:localhost}:${DB_PORT:5432}/${DB_NAME:authdb}
spring.datasource.username=${DB_USERNAME:postgres}
spring.datasource.password=${DB_PASSWORD:password}
# Nombre de connexions ouvertes au démarrage
spring.r2dbc.pool.initial-size=1
# MAX connexions simultanées vers PostgreSQL
spring.r2dbc.pool.max-size=5
# Temps max d’attente pour obtenir une connexion
spring.r2dbc.pool.max-acquire-time=30s
# Libère les connexions inutilisées
spring.r2dbc.pool.max-idle-time=30m
# Recycle les connexions (évite les leaks)
spring.r2dbc.pool.max-life-time=10m
# Retry si le pool est saturé
spring.r2dbc.pool.acquire-retry=3
# Vérification de la connexion
spring.r2dbc.pool.validation-query=SELECT 1
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.database-platform=org.hibernate.spatial.dialect.postgis.PostgisDialect

# Desactiver la securite Servlet auto-configuration
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration,org.springframework.boot.autoconfigure.security.servlet.UserDetailsServiceAutoConfiguration
# Forcer l'utilisation de Netty (serveur reactif)
spring.main.web-application-type=reactive

# Port pour Netty
server.port=${SERVER_PORT:8081}

server.error.include-exception=true
server.error.include-message=always
server.error.include-stacktrace=always


jwt.encryption.key=${JWT_ENCRYPTION_KEY:608f36e92dc66d97d5933f0e6371893cb4fc05b3aa8f8de64014732472303a7c}

# Configuration pour le telechargement de fichiers
file.upload-dir=${UPLOAD_DIR:./uploads}
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB

# Configuration pour les requêtes JSON
spring.webflux.multipart.max-in-memory-size=10MB
server.max-http-request-size=10MB
app.frontend.url=${FRONTEND_URL:http://localhost:3000}

management.endpoints.web.exposure.include=health,info,prometheus
management.endpoint.health.probes.enabled=true
management.metrics.export.prometheus.enabled=true
